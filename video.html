<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>List Video</title>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #121212;
      color: #e0e0e0;
    }

    h1 {
      text-align: center;
      padding: 1rem;
      color: #ffffff;
    }

    .grid-container {
      display: grid;
      gap: 1rem;
      padding: 1rem;
      max-width: 860px;
      margin: auto;
    }

    .video-card {
      background-color: #1e1e1e;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: transform 0.2s;
      display: flex;
      flex-direction: column;
    }

    .video-card:hover {
      transform: translateY(-5px);
    }

    .video-thumb {
      position: relative;
      aspect-ratio: 16 / 9;
      overflow: hidden;
    }

    .video-thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .video-duration {
      position: absolute;
      bottom: 8px;
      right: 8px;
      background-color: rgba(0, 0, 0, 0.7);
      color: #fff;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.75rem;
    }

    .video-info {
      padding: 0.75rem;
      text-align: center;
    }

  .video-title {
    font-size: 1rem;
    margin: 0;
    color: #ffffff;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .header-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  max-width: 860px;
  margin: auto;
}

.header-bar h1 {
  margin: 0;
  font-size: 1.5rem;
}

.header-bar select {
  background-color: #1e1e1e;
  color: #fff;
  border: 1px solid #333;
  padding: 0.4rem 0.6rem;
  border-radius: 6px;
  font-size: 1rem;
}

  /* Grid breakpoints */
  @media (min-width: 0px) {
    .grid-container {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 600px) {
    .grid-container {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .grid-container {
      grid-template-columns: repeat(5, 1fr);
    }
  }

  /* ðŸ”½ Tambahan ini agar judul menyesuaikan */
  @media (max-width: 599px) {
    .video-title {
      font-size: 0.8rem;
    }
  }

  @media (min-width: 600px) and (max-width: 1023px) {
    .video-title {
      font-size: 0.9rem;
    }
  }
  </style>
</head>
<body>
  <div class="header-bar">
  <h1>Video Terbaru</h1>
  <select id="filter" onchange="applyFilter()">
    <option value="terbaru">Video Terbaru</option>
    <option value="terpanjang">Video Terpanjang</option>
    <option value="terpendek">Video Terpendek</option>
    <option value="acak">Video Acak</option>
  </select>
</div>

  <div id="video-list" class="grid-container"></div>

  <div id="pagination" style="text-align: center; padding: 1rem;"></div>

  <script>
  const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRBJj_Zl8uIsIIxfPirvW6JpqZqDPCXSk8D7q7ZxKDPFpQZx0H2x3wBUvtVz9CGjJvUKmGDLFHr9YdE/pub?output=csv";

  let originalData = [];
  let currentPage = 1;
const videosPerPage = 15;

    function getPageFromURL() {
    const match = window.location.pathname.match(/\/page\/(\d+)/);
    return match ? parseInt(match[1]) : 1;
}

  function renderVideos(data, page = 1) {
  currentPage = page;
  const container = document.getElementById('video-list');
  container.innerHTML = '';

  const start = (page - 1) * videosPerPage;
  const end = start + videosPerPage;
  const paginated = data.slice(start, end);

  paginated.forEach(video => {
    if (!video.judul || !video.gambar || !video.durasi) return;

    const card = document.createElement('div');
    card.className = 'video-card';

    card.innerHTML = `
      <div class="video-thumb">
        <img src="${video.gambar}" alt="${video.judul}">
        <div class="video-duration">${video.durasi}</div>
      </div>
      <div class="video-info">
        <div class="video-title">${video.judul}</div>
      </div>
    `;

    container.appendChild(card);
  });

  renderPagination(data.length, page);
}

function renderPagination(totalItems, currentPage) {
  const totalPages = Math.ceil(totalItems / videosPerPage);
  const paginationContainer = document.getElementById('pagination');
  paginationContainer.innerHTML = '';

  const groupSize = 5;
  const currentGroup = Math.floor((currentPage - 1) / groupSize);
  const startPage = currentGroup * groupSize + 1;
  const endPage = Math.min(startPage + groupSize - 1, totalPages);

  // Tombol First
  if (currentPage > 1) {
    addPaginationButton('First', 1);
  }

  // Tombol Prev Group
  if (startPage > 1) {
    addPaginationButton('Prev', startPage - 1);
  }

  // Tombol halaman 1â€“5, 6â€“10, dst
  for (let i = startPage; i <= endPage; i++) {
    addPaginationButton(i, i, i === currentPage);
  }

  // Tombol Next Group
  if (endPage < totalPages) {
    addPaginationButton('Next', endPage + 1);
  }

  // Tombol Last
  if (currentPage < totalPages) {
    addPaginationButton('Last', totalPages);
  }

  function addPaginationButton(label, page, isActive = false) {
    const btn = document.createElement('button');
    btn.textContent = label;
    btn.style.margin = '0 4px';
    btn.style.padding = '6px 12px';
    btn.style.borderRadius = '4px';
    btn.style.border = 'none';
    btn.style.backgroundColor = isActive ? '#333' : '#555';
    btn.style.color = '#fff';
    btn.style.cursor = 'pointer';

    btn.onclick = () => {
      history.pushState(null, '', `/page/${page}`);
      renderVideos(filteredData, page);
    };

    paginationContainer.appendChild(btn);
  }
}

  function durasiToDetik(durasi) {
    const parts = durasi.split(':').map(Number);
    if (parts.length === 3) return parts[0]*3600 + parts[1]*60 + parts[2];
    if (parts.length === 2) return parts[0]*60 + parts[1];
    return parseInt(durasi);
  }

  function parseTanggal(tanggalStr) {
  // Coba format YYYY-MM-DD atau DD/MM/YYYY
  if (tanggalStr.includes('-')) return new Date(tanggalStr);
  if (tanggalStr.includes('/')) {
    const [d, m, y] = tanggalStr.split('/');
    return new Date(`${y}-${m}-${d}`);
  }
  return new Date(tanggalStr);
}

  function applyFilter() {
  const filter = document.getElementById('filter').value;
  filteredData = [...originalData];

  switch (filter) {
    case 'terpanjang':
      filteredData.sort((a, b) => durasiToDetik(b.durasi) - durasiToDetik(a.durasi));
      break;
    case 'terpendek':
      filteredData.sort((a, b) => durasiToDetik(a.durasi) - durasiToDetik(b.durasi));
      break;
    case 'acak':
      filteredData.sort(() => Math.random() - 0.5);
      break;
    case 'terbaru':
      filteredData.sort((a, b) => parseTanggal(b.tanggal) - parseTanggal(a.tanggal));
      break;
  }

  const pageFromURL = getPageFromURL();
  renderVideos(filteredData, pageFromURL);
}

  Papa.parse(SHEET_URL, {
  download: true,
  header: true,
  complete: function(results) {
    originalData = results.data.filter(v => v.judul && v.gambar && v.durasi && v.tanggal);
    applyFilter(); // akan ambil halaman dari URL
  }
});
</script>
</body>
</html>
